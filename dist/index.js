function P(n,...e){return n.reduce((t,r,o)=>t+r+(e[o]||""),"")}import x from"dompurify";var R=(n,e)=>{let r={...{ADD_TAGS:["my-custom-tag"]},...e};return typeof n=="string"?x.sanitize(n,r):x.sanitize(n.innerHTML,r)};var w=(n,e,t)=>{let r=document.querySelector(`#${n}`);r?r.addEventListener(e,t):console.warn(`Element with id '${n}' not found.`)};import{createStore as W}from"zustand/vanilla";import C from"dompurify";function B(n,e){let t=[],r=n.replace(/:[^/]+/g,a=>(t.push(a.slice(1)),"([^/]+)")),o=new RegExp(`^${r}$`),s=e.match(o),i={};return s&&t.forEach((a,l)=>{i[a]=C.sanitize(s[l+1]??"")}),i}function G(n){let e={},t=new URLSearchParams(n);for(let[r,o]of t.entries())e[r]=C.sanitize(o);return e}var T=W((n,e)=>({params:{},query:{},setFromPattern:t=>{let r=window.location.pathname,o=B(t,r),s=G(window.location.search);n({params:o,query:s})},getParam:t=>e().params[t],getQuery:t=>e().query[t]}));function A(n){let e=T.getState();e.setFromPattern(n);let t=e.params,r=e.query;return{...t,...r}}var H=(n,e,t)=>{let r=document.querySelectorAll(n);return r.forEach(o=>{o.addEventListener(e,t)}),()=>{r.forEach(o=>{o.removeEventListener(e,t)})}};import Y from"dompurify";var b=(n,e,t)=>{let r={ALLOWED_TAGS:["main","div","h1","p","button","span","a","img","input"],ALLOWED_ATTR:["class","id","href","style","src","alt"],...t},o=Y.sanitize(e,r);if(n.innerHTML!==String(o))return n.innerHTML=String(o)};import J from"dompurify";var E=null,O=(n,e)=>{if(typeof document>"u")return;let t=document.getElementById(n);if(!t)return;let r=t.innerHTML,o=J.sanitize(r);if(E!==null&&o!==E){let s=document.createElement("div");e(s),t.innerHTML=E}else E=o,e(t)};var v=n=>{let e=document.createElement("div");return e.innerText=n,e.innerHTML},D=(n,e,t,r="",o=null)=>{if(!n)return;let s=v(e),i=v(t),a=r?v(r):void 0;n.setAttribute("href",s),n.setAttribute("aria-label",i),a&&(n.className=a),o&&(n.innerHTML="",n.appendChild(o)),n.addEventListener("click",l=>{l.preventDefault();let m=l.currentTarget.getAttribute("href");if(m){let c=window.scrollY;window.scrollTo(0,0),window.history.pushState({scrollPosition:c},"",m);let p=new PopStateEvent("popstate");dispatchEvent(p)}}),window.addEventListener("popstate",l=>{let u=l.state;u&&u.scrollPosition!==void 0&&window.scrollTo(0,u.scrollPosition)})};import{debounce as K}from"lodash-es";var y=n=>n;typeof window<"u"&&typeof document<"u"&&(y=n=>{let e=document.createElement("div");return e.innerText=n,e.innerHTML});var z=typeof window<"u"?K(n=>{n.forEach(e=>{if(!e)return;let t=e.getAttribute("href")||"#",r=e.getAttribute("class")||"",o=y(t),s=e.getAttribute("class")?y(e.getAttribute("class")):r;e.setAttribute("href",o),e.setAttribute("class",s),e.getAttribute("aria-label")&&e.setAttribute("aria-label",y(e.getAttribute("aria-label")));let i=e.querySelector(":scope > *");i&&(e.innerHTML="",e.appendChild(i)),e.addEventListener("click",a=>{let u=a.currentTarget.getAttribute("href");try{if(new URL(u,window.location.href).origin!==window.location.origin)return}catch(c){console.error("Invalid URL:",c);return}a.preventDefault(),window.history.pushState({},"",u);let m=new PopStateEvent("popstate");window.dispatchEvent(m)})})}):()=>{};import h from"dompurify";var $=(n="'self' 'nonce-rAnd0m123' 'unsafe-inline' 'unsafe-eval'",e="'self' 'nonce-rAnd0m123'",t="'none'",r="'self' https://fonts.googleapis.com https://fonts.gstatic.com",o="'self' https://blogger.googleusercontent.com",s=["'self'","https://fonts.googleapis.com","https://fonts.gstatic.com","https://www.google.com/maps/"],i="'self' https://www.youtube.com",a="'self'",l="/csp-report",u=!1)=>{let m=()=>{try{let c=document.querySelector('meta[http-equiv="Content-Security-Policy"]');c||(c=document.createElement("meta"),c.setAttribute("http-equiv","Content-Security-Policy"),document.head.appendChild(c));let p=u?`report-uri ${l};`:"";c.setAttribute("content",`default-src 'self'; script-src ${n}; style-src ${e}; object-src ${t}; font-src ${r}; img-src ${o}; connect-src ${s.join(" ")}; frame-src ${i}; base-uri ${a}; ${p}`)}catch(c){console.error("Error adding CSP meta element:",c)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m()};var k=(n,e)=>{let t={name:h.sanitize(n.name||""),description:h.sanitize(n.description||"Default description"),author:h.sanitize(n.author||"")},r=d=>{t.name=h.sanitize(d),c("name",t.name)},o=d=>{t.description=h.sanitize(d),c("description",t.description)},s=d=>{t.author=h.sanitize(d),c("author",t.author)},i=()=>t.name,a=()=>t.description,l=()=>t.author,u=()=>t,m=(d,S)=>{let g=document.createElement("meta");g.setAttribute("name",d),g.setAttribute("content",S),document.head.appendChild(g)},c=(d,S)=>{let g=document.querySelector(`meta[name="${d}"]`);g?g.setAttribute("content",S):m(d,S)},p=()=>{c("name",t.name),c("description",t.description),c("author",t.author)};return e&&$(e.scriptSrc,e.styleSrc,e.objectSrc,Array.isArray(e.connectSrc)?e.connectSrc.join(" "):e.connectSrc,e.reportOnly!==void 0?String(e.reportOnly):void 0),p(),{setName:r,setDescription:o,setAuthor:s,getName:i,getDescription:a,getAuthor:l,getAllMetaData:u,appendMetaTagsToHead:p}};import V from"dompurify";var M=(n,e,t,r,o)=>{V.sanitize(e),t(e.querySelector(`#${n}`),r,o)};var q=n=>{let e=document.querySelector(n);return e||(console.warn(`[useTSSelect] No element found for selector: '${n}'`),null)};import{jwtDecode as X}from"jwt-decode";var N=(n,e)=>{let t=localStorage.getItem("token");if(!t)return window.location.href=e,null;try{let r=X(t),o=Date.now()/1e3;return r.exp&&r.exp<o&&(console.error("Token has expired"),window.localStorage.removeItem("token"),window.location.href=e),null}catch(r){return console.error("Invalid token:",r),window.location.href=e,null}};var I=(n,e,t)=>{n.forEach(r=>{e.forEach(o=>{r.addEventListener(o,s=>{t(r,s)})})})};var F=()=>({back:()=>window.history.back(),forward:()=>window.history.forward()});var U=(n,e)=>{let t=document.querySelector(`#${n}`)||document.querySelector(`.${n}`);if(!t)return;let r=window.location.pathname.replace(/\/$/,"");for(let o of e){let s=o.path.replace(/\/$/,"");if(r===s||r.startsWith(`${s}/`)){o.component(t);break}}};function Q(n,e){let t=window.location.pathname.replace(/\/$/,"");e.routes.forEach(r=>{r.children?.length&&r.children.forEach(o=>{let s=o.path.replace(/\/$/,"");if(t===s||t.startsWith(`${s}/`)){let i=n.querySelector(`#${o.outlet}`)||n.querySelector(`.${o.outlet}`);i instanceof HTMLElement&&o.element&&o.element(i)}})})}import j from"dompurify";import{createStore as Z}from"zustand/vanilla";import ee from"dompurify";var f=Z(n=>({params:{},query:{},setParams:e=>n(()=>({params:_(e)})),setQuery:e=>n(()=>({query:_(e)}))}));function _(n){let e={};for(let t in n)e[t]=ee.sanitize(n[t]);return e}var L=class{constructor(e,t){this.routes=[];this.routes=e,this.expectedParams=new Set(t),window.addEventListener("popstate",this.handlePopState.bind(this)),this.handlePopState()}handlePopState(){let e=window.location.pathname,t=window.location.search,r=this.parseQueryParams(t),o=this.findMatchingRoute(e,this.routes);if(o){if(o.routeto){this.navigate(o.routeto);return}let s=this.filterAndSanitizeParams(o.params);f.getState().setParams(s),f.getState().setQuery(r);let i=document.createElement("div");if(o.element?.(i,s,r),o.children){let a=e.slice(o.path.length),l=i.querySelector("#child");l&&this.renderChildren(o.children,a,l,s,r)}}else{let s=this.findMatchingRoute("*",this.routes);if(s){let i=this.filterAndSanitizeParams(s.params);f.getState().setParams(i),f.getState().setQuery(r);let a=document.createElement("div");s.element?.(a,i,r)}}}renderChildren(e,t,r,o,s){if(!e||e.length===0){let a=r.querySelector("#child");a&&a.remove();return}let i=this.findMatchingRoute(t,e);if(i){let a=document.createElement("div");a.id="child";let l={...o,...i.params},u=this.filterAndSanitizeParams(l);if(f.getState().setParams(u),f.getState().setQuery(s),i.element?.(a,u,s),r.appendChild(a),i.children){let m=t.slice(i.path.length);this.renderChildren(i.children,m,a,u,s)}}}parseQueryParams(e){let t={},r=new URLSearchParams(e);for(let[o,s]of r.entries())this.expectedParams.has(o)&&(t[o]=j.sanitize(s));return t}findMatchingRoute(e,t,r={}){for(let o of t){let s=o.path;if(s==="*")return o;{let a=[],l=s.replace(/:[^\s/]+/g,c=>(a.push(c.substring(1)),"([^\\s/]+)")),u=new RegExp(`^${l}(?:/|$)`),m=e.match(u);if(m){let c={...r};if(a.forEach((p,d)=>{c[p]=m[d+1]??""}),o.children){let p=e.slice(m[0].length),d=this.findMatchingRoute(p,o.children,c);if(d)return d}return{...o,params:c}}}}}filterAndSanitizeParams(e){if(!e)return{};let t={};for(let r in e)this.expectedParams.has(r)&&(t[r]=j.sanitize(e[r]??""));return t}navigate(e){history.pushState(null,"",e),this.handlePopState()}addRoute(e){this.routes.push(e)}};export{L as TSRouter,P as html,Q as renderChildRoutes,z as useAnchor,D as useAnchorSingle,O as useInitialDOM,N as useTSAuth,M as useTSComponent,I as useTSElementEach,b as useTSElements,w as useTSEvent,H as useTSEventAll,A as useTSExtractParams,k as useTSMetaData,F as useTSNavigate,U as useTSOutlet,T as useTSParams,R as useTSPurifier,q as useTSSelect};
//# sourceMappingURL=index.js.map