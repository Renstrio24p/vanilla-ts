function P(n,...e){return n.reduce((t,r,o)=>t+r+(e[o]||""),"")}import x from"dompurify";var R=(n,e)=>{let r={...{ADD_TAGS:["my-custom-tag"]},...e};return typeof n=="string"?x.sanitize(n,r):x.sanitize(n.innerHTML,r)};var A=(n,e,t)=>{let r=document.querySelector(`#${n}`);r?r.addEventListener(e,t):console.warn(`Element with id '${n}' not found.`)};import{createStore as Q}from"zustand/vanilla";import w from"dompurify";function _(n,e){let t=[],r=n.replace(/:[^/]+/g,i=>(t.push(i.slice(1)),"([^/]+)")),o=new RegExp(`^${r}$`),s=e.match(o),a={};return s&&t.forEach((i,l)=>{a[i]=w.sanitize(s[l+1]??"")}),a}function j(n){let e={},t=new URLSearchParams(n);for(let[r,o]of t.entries())e[r]=w.sanitize(o);return e}var T=Q((n,e)=>({params:{},query:{},setFromPattern:t=>{let r=window.location.pathname,o=_(t,r),s=j(window.location.search);n({params:o,query:s})},getParam:t=>e().params[t],getQuery:t=>e().query[t]}));function C(n){let e=T.getState();e.setFromPattern(n);let t=e.params,r=e.query;return{...t,...r}}var H=(n,e,t)=>{let r=document.querySelectorAll(n);return r.forEach(o=>{o.addEventListener(e,t)}),()=>{r.forEach(o=>{o.removeEventListener(e,t)})}};import B from"dompurify";var b=(n,e,t)=>{let r={ALLOWED_TAGS:["main","div","h1","p","button","span","a","img","input"],ALLOWED_ATTR:["class","id","href","style","src","alt"],...t},o=B.sanitize(e,r);if(n.innerHTML!==String(o))return n.innerHTML=String(o)};import G from"dompurify";var E=null,D=(n,e)=>{if(typeof document>"u")return;let t=document.getElementById(n);if(!t)return;let r=t.innerHTML,o=G.sanitize(r);if(E!==null&&o!==E){let s=document.createElement("div");e(s),t.innerHTML=E}else E=o,e(t)};var v=n=>{let e=document.createElement("div");return e.innerText=n,e.innerHTML},O=(n,e,t,r="",o=null)=>{if(!n)return;let s=v(e),a=v(t),i=r?v(r):void 0;n.setAttribute("href",s),n.setAttribute("aria-label",a),i&&(n.className=i),o&&(n.innerHTML="",n.appendChild(o)),n.addEventListener("click",l=>{l.preventDefault();let m=l.currentTarget.getAttribute("href");if(m){let c=window.scrollY;window.scrollTo(0,0),window.history.pushState({scrollPosition:c},"",m);let g=new PopStateEvent("popstate");dispatchEvent(g)}}),window.addEventListener("popstate",l=>{let u=l.state;u&&u.scrollPosition!==void 0&&window.scrollTo(0,u.scrollPosition)})};import{debounce as W}from"lodash-es";var y=n=>n;typeof window<"u"&&typeof document<"u"&&(y=n=>{let e=document.createElement("div");return e.innerText=n,e.innerHTML});var z=typeof window<"u"?W(n=>{n.forEach(e=>{if(!e)return;let t=e.getAttribute("href")||"#",r=e.getAttribute("class")||"",o=y(t),s=e.getAttribute("class")?y(e.getAttribute("class")):r;e.setAttribute("href",o),e.setAttribute("class",s),e.getAttribute("aria-label")&&e.setAttribute("aria-label",y(e.getAttribute("aria-label")));let a=e.querySelector(":scope > *");a&&(e.innerHTML="",e.appendChild(a)),e.addEventListener("click",i=>{let u=i.currentTarget.getAttribute("href");try{if(new URL(u,window.location.href).origin!==window.location.origin)return}catch(c){console.error("Invalid URL:",c);return}i.preventDefault(),window.history.pushState({},"",u);let m=new PopStateEvent("popstate");window.dispatchEvent(m)})})}):()=>{};import h from"dompurify";var k=(n="'self' 'nonce-rAnd0m123' 'unsafe-inline' 'unsafe-eval'",e="'self' 'nonce-rAnd0m123'",t="'none'",r="'self' https://fonts.googleapis.com https://fonts.gstatic.com",o="'self' https://blogger.googleusercontent.com",s=["'self'","https://fonts.googleapis.com","https://fonts.gstatic.com","https://www.google.com/maps/"],a="'self' https://www.youtube.com",i="'self'",l="/csp-report",u=!1)=>{let m=()=>{try{let c=document.querySelector('meta[http-equiv="Content-Security-Policy"]');c||(c=document.createElement("meta"),c.setAttribute("http-equiv","Content-Security-Policy"),document.head.appendChild(c));let g=u?`report-uri ${l};`:"";c.setAttribute("content",`default-src 'self'; script-src ${n}; style-src ${e}; object-src ${t}; font-src ${r}; img-src ${o}; connect-src ${s.join(" ")}; frame-src ${a}; base-uri ${i}; ${g}`)}catch(c){console.error("Error adding CSP meta element:",c)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m()};var q=(n,e)=>{let t={name:h.sanitize(n.name||""),description:h.sanitize(n.description||"Default description"),author:h.sanitize(n.author||"")},r=d=>{t.name=h.sanitize(d),c("name",t.name)},o=d=>{t.description=h.sanitize(d),c("description",t.description)},s=d=>{t.author=h.sanitize(d),c("author",t.author)},a=()=>t.name,i=()=>t.description,l=()=>t.author,u=()=>t,m=(d,S)=>{let p=document.createElement("meta");p.setAttribute("name",d),p.setAttribute("content",S),document.head.appendChild(p)},c=(d,S)=>{let p=document.querySelector(`meta[name="${d}"]`);p?p.setAttribute("content",S):m(d,S)},g=()=>{c("name",t.name),c("description",t.description),c("author",t.author)};return e&&k(e.scriptSrc,e.styleSrc,e.objectSrc,Array.isArray(e.connectSrc)?e.connectSrc.join(" "):e.connectSrc,e.reportOnly!==void 0?String(e.reportOnly):void 0),g(),{setName:r,setDescription:o,setAuthor:s,getName:a,getDescription:i,getAuthor:l,getAllMetaData:u,appendMetaTagsToHead:g}};import Y from"dompurify";var M=(n,e,t,r,o)=>{Y.sanitize(e),t(e.querySelector(`#${n}`),r,o)};var $=n=>{let e=document.querySelector(n);return e||(console.warn(`[useTSSelect] No element found for selector: '${n}'`),null)};import{jwtDecode as J}from"jwt-decode";var N=(n,e)=>{let t=localStorage.getItem("token");if(!t)return window.location.href=e,null;try{let r=J(t),o=Date.now()/1e3;return r.exp&&r.exp<o&&(console.error("Token has expired"),window.localStorage.removeItem("token"),window.location.href=e),null}catch(r){return console.error("Invalid token:",r),window.location.href=e,null}};var I=(n,e,t)=>{n.forEach(r=>{e.forEach(o=>{r.addEventListener(o,s=>{t(r,s)})})})};import U from"dompurify";import{createStore as K}from"zustand/vanilla";import V from"dompurify";var f=K(n=>({params:{},query:{},setParams:e=>n(()=>({params:F(e)})),setQuery:e=>n(()=>({query:F(e)}))}));function F(n){let e={};for(let t in n)e[t]=V.sanitize(n[t]);return e}var L=class{constructor(e,t){this.routes=[];this.routes=e,this.expectedParams=new Set(t),window.addEventListener("popstate",this.handlePopState.bind(this)),this.handlePopState()}handlePopState(){let e=window.location.pathname,t=window.location.search,r=this.parseQueryParams(t),o=this.findMatchingRoute(e,this.routes);if(o){if(o.routeto){this.navigate(o.routeto);return}let s=this.filterAndSanitizeParams(o.params);f.getState().setParams(s),f.getState().setQuery(r);let a=document.createElement("div");if(o.element?.(a,s,r),o.children){let i=e.slice(o.path.length),l=a.querySelector("#child");l&&this.renderChildren(o.children,i,l,s,r)}}else{let s=this.findMatchingRoute("*",this.routes);if(s){let a=this.filterAndSanitizeParams(s.params);f.getState().setParams(a),f.getState().setQuery(r);let i=document.createElement("div");s.element?.(i,a,r)}}}renderChildren(e,t,r,o,s){if(!e||e.length===0){let i=r.querySelector("#child");i&&i.remove();return}let a=this.findMatchingRoute(t,e);if(a){let i=document.createElement("div");i.id="child";let l={...o,...a.params},u=this.filterAndSanitizeParams(l);if(f.getState().setParams(u),f.getState().setQuery(s),a.element?.(i,u,s),r.appendChild(i),a.children){let m=t.slice(a.path.length);this.renderChildren(a.children,m,i,u,s)}}}parseQueryParams(e){let t={},r=new URLSearchParams(e);for(let[o,s]of r.entries())this.expectedParams.has(o)&&(t[o]=U.sanitize(s));return t}findMatchingRoute(e,t,r={}){for(let o of t){let s=o.path;if(s==="*")return o;{let i=[],l=s.replace(/:[^\s/]+/g,c=>(i.push(c.substring(1)),"([^\\s/]+)")),u=new RegExp(`^${l}(?:/|$)`),m=e.match(u);if(m){let c={...r};if(i.forEach((g,d)=>{c[g]=m[d+1]??""}),o.children){let g=e.slice(m[0].length),d=this.findMatchingRoute(g,o.children,c);if(d)return d}return{...o,params:c}}}}}filterAndSanitizeParams(e){if(!e)return{};let t={};for(let r in e)this.expectedParams.has(r)&&(t[r]=U.sanitize(e[r]??""));return t}navigate(e){history.pushState(null,"",e),this.handlePopState()}addRoute(e){this.routes.push(e)}};export{L as TSRouter,P as html,z as useAnchor,O as useAnchorSingle,D as useInitialDOM,N as useTSAuth,M as useTSComponent,I as useTSElementEach,b as useTSElements,A as useTSEvent,H as useTSEventAll,C as useTSExtractParams,q as useTSMetaData,T as useTSParams,R as useTSPurifier,$ as useTSSelect};
//# sourceMappingURL=index.js.map