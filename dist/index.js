function v(n,...e){return n.reduce((t,r,o)=>t+r+(e[o]||""),"")}import M from"dompurify";var L=(n,e)=>{let r={...{ADD_TAGS:["my-custom-tag"]},...e};return typeof n=="string"?M.sanitize(n,r):M.sanitize(n.innerHTML,r)};var P=(n,e,t)=>{let r=document.querySelector(`#${n}`);r?r.addEventListener(e,t):console.warn(`Element with id '${n}' not found.`)};import{createStore as $}from"zustand/vanilla";import x from"dompurify";function N(n,e){let t=[],r=n.replace(/:[^/]+/g,i=>(t.push(i.slice(1)),"([^/]+)")),o=new RegExp(`^${r}$`),s=e.match(o),a={};return s&&t.forEach((i,c)=>{a[i]=x.sanitize(s[c+1]??"")}),a}function I(n){let e={},t=new URLSearchParams(n);for(let[r,o]of t.entries())e[r]=x.sanitize(o);return e}var p=$((n,e)=>({params:{},query:{},setFromPattern:t=>{let r=window.location.pathname,o=N(t,r),s=I(window.location.search);n({params:o,query:s})},getParam:t=>e().params[t],getQuery:t=>e().query[t]}));function R(n){let e=p.getState();e.setFromPattern(n);let t=e.params,r=e.query;return{...t,...r}}var A=(n,e,t)=>{let r=document.querySelectorAll(n);return r.forEach(o=>{o.addEventListener(e,t)}),()=>{r.forEach(o=>{o.removeEventListener(e,t)})}};import F from"dompurify";var w=(n,e,t)=>{let r={ALLOWED_TAGS:["main","div","h1","p","button","span","a","img","input"],ALLOWED_ATTR:["class","id","href","style","src","alt"],...t},o=F.sanitize(e,r);if(n.innerHTML!==String(o))return n.innerHTML=String(o)};import U from"dompurify";var h=null,C=(n,e)=>{if(typeof document>"u")return;let t=document.getElementById(n);if(!t)return;let r=t.innerHTML,o=U.sanitize(r);if(h!==null&&o!==h){let s=document.createElement("div");e(s),t.innerHTML=h}else h=o,e(t)};var T=n=>{let e=document.createElement("div");return e.innerText=n,e.innerHTML},H=(n,e,t,r="",o=null)=>{if(!n)return;let s=T(e),a=T(t),i=r?T(r):void 0;n.setAttribute("href",s),n.setAttribute("aria-label",a),i&&(n.className=i),o&&(n.innerHTML="",n.appendChild(o)),n.addEventListener("click",c=>{c.preventDefault();let u=c.currentTarget.getAttribute("href");if(u){let m=window.scrollY;window.scrollTo(0,0),window.history.pushState({scrollPosition:m},"",u);let g=new PopStateEvent("popstate");dispatchEvent(g)}}),window.addEventListener("popstate",c=>{let l=c.state;l&&l.scrollPosition!==void 0&&window.scrollTo(0,l.scrollPosition)})};import Q from"lodash";var S=n=>n;typeof window<"u"&&typeof document<"u"&&(S=n=>{let e=document.createElement("div");return e.innerText=n,e.innerHTML});var b=typeof window<"u"?Q(n=>{n.forEach(e=>{if(!e)return;let t=e.getAttribute("href")||"#",r=e.getAttribute("class")||"",o=S(t),s=e.getAttribute("class")?S(e.getAttribute("class")):r;e.setAttribute("href",o),e.setAttribute("class",s),e.getAttribute("aria-label")&&e.setAttribute("aria-label",S(e.getAttribute("aria-label")));let a=e.querySelector(":scope > *");a&&(e.innerHTML="",e.appendChild(a)),e.addEventListener("click",i=>{let l=i.currentTarget.getAttribute("href");try{if(new URL(l,window.location.href).origin!==window.location.origin)return}catch(m){console.error("Invalid URL:",m);return}i.preventDefault(),window.history.pushState({},"",l);let u=new PopStateEvent("popstate");window.dispatchEvent(u)})})}):()=>{};import he from"dompurify";import _ from"dompurify";var E=(n,e,t,r,o)=>{_.sanitize(e),t(e.querySelector(`#${n}`),r,o)};var D=n=>{let e=document.querySelector(n);return e||(console.warn(`[useTSSelect] No element found for selector: '${n}'`),null)};import{jwtDecode as j}from"jwt-decode";var O=(n,e)=>{let t=localStorage.getItem("token");if(!t)return window.location.href=e,null;try{let r=j(t),o=Date.now()/1e3;return r.exp&&r.exp<o&&(console.error("Token has expired"),window.localStorage.removeItem("token"),window.location.href=e),null}catch(r){return console.error("Invalid token:",r),window.location.href=e,null}};var z=(n,e,t)=>{n.forEach(r=>{e.forEach(o=>{r.addEventListener(o,s=>{t(r,s)})})})};import q from"dompurify";import{createStore as B}from"zustand/vanilla";import G from"dompurify";var d=B(n=>({params:{},query:{},setParams:e=>n(()=>({params:k(e)})),setQuery:e=>n(()=>({query:k(e)}))}));function k(n){let e={};for(let t in n)e[t]=G.sanitize(n[t]);return e}var y=class{constructor(e,t){this.routes=[];this.routes=e,this.expectedParams=new Set(t),window.addEventListener("popstate",this.handlePopState.bind(this)),this.handlePopState()}handlePopState(){let e=window.location.pathname,t=window.location.search,r=this.parseQueryParams(t),o=this.findMatchingRoute(e,this.routes);if(o){if(o.routeto){this.navigate(o.routeto);return}let s=this.filterAndSanitizeParams(o.params);d.getState().setParams(s),d.getState().setQuery(r);let a=document.createElement("div");if(o.element?.(a,s,r),o.children){let i=e.slice(o.path.length),c=a.querySelector("#child");c&&this.renderChildren(o.children,i,c,s,r)}}else{let s=this.findMatchingRoute("*",this.routes);if(s){let a=this.filterAndSanitizeParams(s.params);d.getState().setParams(a),d.getState().setQuery(r);let i=document.createElement("div");s.element?.(i,a,r)}}}renderChildren(e,t,r,o,s){if(!e||e.length===0){let i=r.querySelector("#child");i&&i.remove();return}let a=this.findMatchingRoute(t,e);if(a){let i=document.createElement("div");i.id="child";let c={...o,...a.params},l=this.filterAndSanitizeParams(c);if(d.getState().setParams(l),d.getState().setQuery(s),a.element?.(i,l,s),r.appendChild(i),a.children){let u=t.slice(a.path.length);this.renderChildren(a.children,u,i,l,s)}}}parseQueryParams(e){let t={},r=new URLSearchParams(e);for(let[o,s]of r.entries())this.expectedParams.has(o)&&(t[o]=q.sanitize(s));return t}findMatchingRoute(e,t,r={}){for(let o of t){let s=o.path;if(s==="*")return o;{let i=[],c=s.replace(/:[^\s/]+/g,m=>(i.push(m.substring(1)),"([^\\s/]+)")),l=new RegExp(`^${c}(?:/|$)`),u=e.match(l);if(u){let m={...r};if(i.forEach((g,f)=>{m[g]=u[f+1]??""}),o.children){let g=e.slice(u[0].length),f=this.findMatchingRoute(g,o.children,m);if(f)return f}return{...o,params:m}}}}}filterAndSanitizeParams(e){if(!e)return{};let t={};for(let r in e)this.expectedParams.has(r)&&(t[r]=q.sanitize(e[r]??""));return t}navigate(e){history.pushState(null,"",e),this.handlePopState()}addRoute(e){this.routes.push(e)}};export{y as TSRouter,v as html,b as useAnchor,H as useAnchorSingle,C as useInitialDOM,O as useTSAuth,E as useTSComponent,z as useTSElementEach,w as useTSElements,P as useTSEvent,A as useTSEventAll,R as useTSExtractParams,p as useTSParams,L as useTSPurifier,D as useTSSelect};
//# sourceMappingURL=index.js.map